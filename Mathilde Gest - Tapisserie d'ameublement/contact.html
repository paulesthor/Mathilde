<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact | Mathilde Gest</title>
    <link rel="stylesheet" href="css/style.css?v=3">
    <link rel="stylesheet" href="css/navigation.css?v=3">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>

<body>

    <!-- HEADER MOBILE -->
    <div class="mobile-header">
        <a href="index.html" class="mobile-logo">MATHILDE GEST</a>
        <button class="burger-btn" id="burger-toggle">
            <span class="burger-line"></span>
            <span class="burger-line"></span>
            <span class="burger-line"></span>
        </button>
    </div>

    <!-- SIDEBAR NAVIGATION -->
    <aside class="sidebar" id="sidebar">
        <a href="index.html" class="sidebar-logo">
            <div class="logo-text">Mat.<br>Gest</div>
            <span class="logo-sub">Atelier Paris</span>
        </a>

        <nav class="sidebar-nav">
            <ul>
                <li><a href="index.html">Accueil</a></li>
                <li><a href="categories.html">Créations</a></li>
                <li><a href="piece-of-the-month.html">Le Mois</a></li>
                <li><a href="contact.html" class="active">Atelier</a></li>
            </ul>
        </nav>

        <div class="sidebar-footer">
            <!-- Auth buttons - Dynamic based on user state -->
            <div class="auth-links" style="margin-bottom: 2rem;">
                <a href="signup.html" class="btn btn-outline"
                    style="display: block; text-align: center; margin-bottom: 0.5rem; padding: 0.8rem;">S'inscrire</a>
                <a href="login.html" class="btn btn-primary"
                    style="display: block; text-align: center; padding: 0.8rem;">Connexion</a>
            </div>
            <p style="font-size: 0.85rem; line-height: 1.6;">12 Rue de la Tapisserie<br>75000 Paris</p>
            <div style="font-size: 0.75rem; margin-top: 1rem;">
                <a href="mentions-legales.html" style="text-decoration: underline;">Mentions Légales</a><br>
                <a href="politique-confidentialite.html" style="text-decoration: underline;">Politique de
                    Confidentialité</a>
            </div>
        </div>
    </aside>

    <!-- MAIN CONTENT WRAPPER -->
    <main class="main-content" style="padding: 4rem;">

        <div class="contact-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 4rem;">

            <!-- LEFT COLUMN: Forms -->
            <div class="contact-forms">

                <!-- TABS for toggling forms -->
                <div class="form-tabs"
                    style="margin-bottom: 2rem; border-bottom: 1px solid #ddd; display: flex; gap: 2rem;">
                    <button class="tab-btn active" onclick="switchForm('message')"
                        style="padding: 1rem 0; background: none; border: none; font-family: inherit; font-size: 1.1rem; cursor: pointer; border-bottom: 2px solid var(--color-primary);">Envoyer
                        un Message / Devis</button>
                    <button class="tab-btn" onclick="switchForm('rdv')"
                        style="padding: 1rem 0; background: none; border: none; font-family: inherit; font-size: 1.1rem; cursor: pointer; color: #999;">Prendre
                        Rendez-vous</button>
                </div>

                <!-- MESSAGE FORM -->
                <form id="contact-form" class="active-form">
                    <input type="hidden" name="type" value="contact">
                    <div class="form-group">
                        <label>Votre Nom</label>
                        <input type="text" name="name" required
                            style="width: 100%; padding: 0.8rem; margin-bottom: 1rem; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div class="form-group">
                        <label>Votre Email</label>
                        <input type="email" name="email" required
                            style="width: 100%; padding: 0.8rem; margin-bottom: 1rem; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div class="form-group">
                        <label>Sujet (Demande de devis, information...)</label>
                        <input type="text" name="subject" required
                            style="width: 100%; padding: 0.8rem; margin-bottom: 1rem; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div class="form-group">
                        <label>Message</label>
                        <textarea name="content" rows="5" required
                            style="width: 100%; padding: 0.8rem; margin-bottom: 1rem; border: 1px solid #ddd; border-radius: 4px; font-family: inherit;"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Envoyer</button>
                    <div id="contact-feedback" style="margin-top: 1rem;"></div>
                </form>

                <!-- APPOINTMENT FORM (Hidden by default) -->
                <form id="appointment-form" style="display: none;">
                    <div class="form-group">
                        <label>Votre Nom</label>
                        <input type="text" name="client_name" required
                            style="width: 100%; padding: 0.8rem; margin-bottom: 1rem; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div class="form-group">
                        <label>Votre Email</label>
                        <input type="email" name="client_email" required
                            style="width: 100%; padding: 0.8rem; margin-bottom: 1rem; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div class="form-group">
                        <label>Téléphone (Optionnel)</label>
                        <input type="tel" name="client_phone"
                            style="width: 100%; padding: 0.8rem; margin-bottom: 1rem; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div class="form-group">
                        <label>Date souhaitée</label>
                        <input type="datetime-local" name="requested_date" required
                            style="width: 100%; padding: 0.8rem; margin-bottom: 1rem; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div class="form-group">
                        <label>Motif du rendez-vous</label>
                        <textarea name="message" rows="3"
                            style="width: 100%; padding: 0.8rem; margin-bottom: 1rem; border: 1px solid #ddd; border-radius: 4px; font-family: inherit;"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Demander le Rendez-vous</button>
                    <p style="font-size: 0.85rem; color: #666; margin-top: 0.5rem;">* Nous vous confirmerons le créneau
                        par email.</p>
                    <div id="rdv-feedback" style="margin-top: 1rem;"></div>
                </form>
            </div>

            <!-- RIGHT COLUMN: Info & Map -->
            <div class="contact-info-map">
                <section class="contact-info" style="margin-bottom: 3rem;">
                    <h1 data-content-key="contact_title">Contactez-nous</h1>
                    <p data-content-key="contact_intro" style="margin-bottom: 2rem;">Pour toute demande de devis, visite
                        à l'atelier ou information sur nos tissus...</p>

                    <div class="contact-details">
                        <p style="margin-bottom: 0.5rem;"><strong>Adresse:</strong> <span
                                data-content-key="contact_address">12 Rue de la Tapisserie, 75000 Paris</span></p>
                        <p style="margin-bottom: 0.5rem;"><strong>Téléphone:</strong> <span
                                data-content-key="contact_phone">01 23 45 67 89</span></p>
                        <p><strong>Email:</strong> <span
                                data-content-key="contact_email">contact@mathildegest.com</span></p>
                    </div>
                </section>

                <section class="map-section">
                    <h2 data-content-key="map_title" style="margin-bottom: 1rem; font-size: 1.2rem;">Nous trouver à
                        l'atelier</h2>
                    <div id="map"
                        style="height: 300px; width: 100%; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                    </div>
                </section>
            </div>
        </div>

        <script>
            function switchForm(type) {
                const buttons = document.querySelectorAll('.tab-btn');
                const contactForm = document.getElementById('contact-form');
                const rdvForm = document.getElementById('appointment-form');

                if (type === 'message') {
                    contactForm.style.display = 'block';
                    rdvForm.style.display = 'none';
                    buttons[0].classList.add('active');
                    buttons[0].style.borderBottom = '2px solid var(--color-primary)';
                    buttons[0].style.color = 'var(--color-primary)';
                    buttons[1].classList.remove('active');
                    buttons[1].style.borderBottom = 'none';
                    buttons[1].style.color = '#999';
                } else {
                    contactForm.style.display = 'none';
                    rdvForm.style.display = 'block';
                    buttons[1].classList.add('active');
                    buttons[1].style.borderBottom = '2px solid var(--color-primary)';
                    buttons[1].style.color = 'var(--color-primary)';
                    buttons[0].classList.remove('active');
                    buttons[0].style.borderBottom = 'none';
                    buttons[0].style.color = '#999';
                }
            }
        </script>
    </main>

    <script>
        const burger = document.getElementById('burger-toggle');
        const sidebar = document.getElementById('sidebar');
        if (burger && sidebar) {
            burger.addEventListener('click', () => sidebar.classList.toggle('open'));
        }
    </script>

    <script type="module" src="js/config.js"></script>
    <script type="module" src="js/auth.js"></script>
    <script type="module" src="js/image-utils.js"></script>
    <script type="module" src="js/admin.js"></script>
    <script type="module" src="js/main.js"></script>
    <script type="module" src="js/contact.js"></script>

    <script>
        // Initialize Leaflet Map
        document.addEventListener('DOMContentLoaded', () => {
            const map = L.map('map').setView([48.8566, 2.3522], 13); // Default Paris

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            L.marker([48.8566, 2.3522]).addTo(map)
                .bindPopup('Mathilde Gest - Atelier')
                .openPopup();
        });
    </script>
</body>

</html>